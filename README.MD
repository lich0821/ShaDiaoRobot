# ç¾¤ä¸»çš„æ²™é›•æœºå™¨äºº
åŸºäº [Rasa](https://github.com/rasaHQ/rasa) çš„ä¸€ä¸ªæœºå™¨äººç¤ºä¾‹ã€‚

## ç¯å¢ƒæ­å»º
### å®‰è£… Python
å®˜æ–¹è¯´æ”¯æŒ `3.7`ï¼Œ`3.8`ï¼Œ`3.9` å’Œ `3.10`ï¼Œä½† `3.7` å¤ªæ—§äº†ï¼›`3.10` åˆè¦æ±‚è›®å¤šï¼›å»ºè®® `3.8` æˆ–è€… `3.9`ã€‚

### åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
```sh
python -m venv .env

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source .env/bin/activate
```

### å®‰è£… RASA å¼€æºç‰ˆ
```sh
# æ›´æ–° pip
pip install -U pip

# å®‰è£… RASA
pip install rasa
```

## å¿«é€Ÿå¼€å§‹
### å…‹éš†é¡¹ç›®
```sh
git clone
```

### å®‰è£…ä¾èµ–
```sh
pip install -r requirements.txt
```

### è®­ç»ƒæ¨¡å‹
```sh
rasa train
# è®­ç»ƒæ—¶é‡åˆ°ç½‘ç»œæŠ¥é”™çš„è¯ï¼Œéœ€è¦ç§‘å­¦ä¸€ä¸‹
```

### è¿è¡Œ Action æœåŠ¡
#### é—²èŠ
é—²èŠæ¨¡å‹éœ€è¦å…ˆè®­ç»ƒã€‚
```sh
# åˆ‡æ¢åˆ° actions ç›®å½•
cd actions/
python chitchat_helper.py -m train
```

å¦‚æœæ²¡æœ‰ GPUï¼Œè®­ç»ƒå¯èƒ½æ¯”è¾ƒè´¹åŠ²ï¼Œå¯ä»¥ä» [release](https://github.com/lich0821/ShaDiaoRobot/releases/latest) å¤„ä¸‹è½½è®­ç»ƒå¥½çš„æ¨¡å‹ï¼ˆè™½ç„¶ä¹Ÿè®­ç»ƒå¾—ä¸æ€ä¹ˆæ ·ï¼‰ï¼Œè§£å‹åˆ° `actions/chitchat/model_data`ï¼š
```
actions/chitchat/model_data
â”œâ”€â”€ checkpoint
â”œâ”€â”€ ckpt-10.data-00000-of-00001
â””â”€â”€ ckpt-10.index
```


Tensorflow çš„å…¼å®¹æ€§ä¸è¡Œï¼Œæ³¨æ„ç‰ˆæœ¬ï¼š
> tensorflow                   2.12.0
> tensorflow-estimator         2.12.0
> tensorflow-hub               0.13.0
> tensorflow-io-gcs-filesystem 0.32.0
> tensorflow-text              2.12.0

#### å¤©æ°”
å»[çŸ¥å¿ƒå¤©æ°”](https://www.seniverse.com/)æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œå¯ä»¥å…è´¹ä½¿ç”¨å¤©æ°”æ¥å£ã€‚

```sh
# è®¾ç½® KEY
export WEATHER_KEY=your_key

rasa run actions
```

### å¯åŠ¨ RASA API
```sh
rasa run --enable-api
```

### éªŒè¯
* cURL
```sh
curl --location 'http://localhost:5005/webhooks/rest/webhook' \
--data '{
    "sender": "user1",
    "message": "æ˜å¤©åŒ—äº¬å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ"
}'
```

* Python
```py
import requests

url = "http://localhost:5005/webhooks/rest/webhook"

payload = "{\n    \"sender\": \"user1\",\n    \"message\": \"æ˜å¤©åŒ—äº¬å¤©æ°”æ€ä¹ˆæ ·ï¼Ÿ\"\n}"
headers = {}

response = requests.request("POST", url, headers=headers, data=payload)

print(response.text)
```

## ä»é›¶åˆ›å»ºé¡¹ç›®
å¿½ç•¥ä¸€ä¸ª `SQLAlchemy` å‘Šè­¦ï¼š
```sh
export SQLALCHEMY_SILENCE_UBER_WARNING=1
```

### åˆå§‹åŒ–é¡¹ç›®
```sh
rasa init
```

```txt
Welcome to Rasa! ğŸ¤–

To get started quickly, an initial project will be created.
If you need some help, check out the documentation at https://rasa.com/docs/rasa.
Now let's start! ğŸ‘‡ğŸ½

? Please enter a path where the project will be created [default: current directory]
? Directory 'RasaDemo' is not empty. Continue? Yes
â€¦â€¦
Created project directory at 'RasaDemo'.
Finished creating project structure.
? ? Do you want to train an initial model? ğŸ’ªğŸ½ No
No problem ğŸ‘ğŸ¼. You can also train a model later by going to the project directory and running 'rasa train'.
```

è¿™æ ·å°±æœ‰ä¸€ä¸ªç¤ºä¾‹é¡¹ç›®ï¼›ä¹Ÿå¯ä»¥é€‰æ‹©è®­ç»ƒè·‘è·‘ã€‚ç„¶ååŸºç¤ºä¾‹é¡¹ç›®æ”¹ã€‚

Once you've done the following, you can train your bot and try it out!

* Add RulePolicy to your policies and ResponseSelector to your pipeline in config.yml
* Add at least one rule for responding to FAQs/chitchat
* Add examples for your FAQs/chitchat intents
* Add responses for your FAQs/chitchat intents
* Update the intents in your domain

## è°ƒè¯•
```sh
rasa shell --debug
```
